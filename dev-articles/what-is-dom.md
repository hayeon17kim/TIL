## DOM이란 무엇인가?

문서 객체 모델(The Documnet Object Model ,DOM)은 HTML, XML의 프로그래밍 interface이다.

### 내가 작성한 HTML 코드가 DOM이다?

아니다. 하지만 내가 작성한 코드가 브라우저에 의해 파싱되면 DOM이 된다.

### 페이지 View Source가 DOM이다?

아니다. View Source는 그 페이지를 이루고 있는 HTML을 보여줄 뿐이며, 내가 작성한 HTML과 같다. 하지만 코드 작성 시 백엔드 언어를 사용한 템플릿 파일을 이용한 경우, 정확히는 컴파일된 결과를 말하는 것이다. 혹은 작성된 코드에 대해 빌드 과정을 거친 다음에 웹 사이트에 배포되는 경우에는 HTML 코드는 압축되거나 변형되었을 수도 있다.

### DevTools에서 보이는 코드가 DOM이다. 

그렇다. 브라우저에서 지원하는 개발자 툴에서 보이는 것이 DOM이다. 이 툴에서 시각적으로 표현한 DOM이 나의 HTML 코드와 동일할 수는 있지만, 대개는 달라지게 되며 Devtool에서는 이러한 변경 사항이 적용되어 표시된다.

## DOM이 HTML과 달라지는 경우가 있을까?

### Case1: 브라우저가 HTML을 수정한 경우

내가 작성한 HTML에 실수가 있고, 브라우저가 이를 고친 경우이다. 테이블 엘리먼트 작성 시 필요 조건인 `<tbody>`를 빼먹고 `<table>`을 작성했다고 하자. 브라우저는 `<tbody>`를 대신 자동으로 넣어 준 다음 DOM을 만든다.

- `<tbody>`
- HTML 파일에 "Hello" 단어 한만 존재하더라도 브라우저는 이를 `html`과 `body`로 감싸고, `head`를 필수적으로 추가해준다.
- DOM을 생성하는 과정에서 태그의 닫는 짝이 없는 경우 자동 생성하여 맞춰서 오류를 수정해준다.
- 자동 교정의 특이 케이스로, `<table>`은 항상 `<tbody>`를 가져야 하므로 `<tbody>`를 빠뜨렸을 경우 DOM이 생성될 때 자동으로 추가한다.

### Case2: JavaScript로 DOM을 조작하는 경우

```html
<div id="container"></div>
```

```js
var container = document.getElementById("container");
container.innerHTML = "New Content!";
```

개발자 도구의 DOM을 체크하면 다음과 같이 바뀐다.

```html
<div id="container">New Content!</div>
```

### Other Cases: Ajax and Templating

- Ajax를 통해 어딘가에서 컨텐츠를 가져와서 현재 페이지에 넣거나, 클라이언트 사이드 템플리팅을 사용하는 경우에도 원래의 HTML과는 달라진다.

> 템플릿은 페이지에 삽입하는 HTML의 한 부분이다. 템플릿은 보통 서버 사이드에서 생성된다. 이곳에서 자바스크립트가 어쩌구. 자바스크립트 안에 템플릿을 넣는 것이 이상적이다. 그러나 

### 브라우저 Inspector

- 브라우저의 개발자 툴로 DOM을 탐색할 때 개발자 툴의 DOM 구조는 단순화되어 있다.



## Critical Rendering Path

브라우저가 서버에서 페이지에 대한 HTML 응답을 받으면 화면에 표시되기 젙ㄴ에 많은 단계를 거쳐야 하는데 웹 브라우저가 원본 HTML문서를 읽어들인 후, 스타일을 입히고 대화형 페이지로 만들어 뷰 포트에 표시하기까지의 과정을 Critical Rendering Path, CRP이라고 한다.

### CRP의 6단계 과정

- DOM 트리 구축
- CSSSOM 트리 구축
- JavaScript  실행
- 렌더 트리 구축
- 레이아웃 생성
- 페인팅

렌더 트리 구축을 기점으로 하면 두 단계로 나눌 수 있다. 

- 브라우저는 읽어들인 문서를 파싱하여 최종적으로 어떤 내용을 페이지에 렌더링할지 결정한다.
- 브라우저는 해당 렌더링을 수행한다.

![img](https://media.vlpt.us/post-images/surim014/78564f80-2cd5-11ea-b5ba-13b53e7b23f0/image.png)

### 렌더 트리

웹 페이지에 표시될 HTML 요소들과 이와 관련된 스타일 요소들로 구성된다. 브라우저는 렌더 트리를 생성하기 위해 아래와 같이 두 모델이 필요하다.

- **DOM**: HTML 요소들의 구조화된 표현
- **CSSOM**: 요소들과 연관된 스타일 정보의 구조화된 표현



## DOM

**웹 페이지에 대한 프로그래밍 인터페이스이**다. 기본적으로 여러 프로그램들이 **페이지의 콘텐츠 및 구조, 그리고 스타일을 읽고 조작할** 수 있는 **API를 제공**한다.

### DOM의 생성 방식

DOM은 원본 HTML 문서의 객체 기반 표현 방식이며, DOM의 개체 구조는 노드 트리로 표현된다.

### DOM과 HTML의 차이점

DOM은 HTML문서로 생성되지만 항상 동일하지는 않다.

- HTML은 화면에 보이고자 하는 모양과 구조를 문서로 만든 것으로 단순 텍스트로 구성되어 있다. (최초에 화면을 그릴 때 사용하는 설계도)
- DOM은 HTML 문서의 내용과 구조가 객체 모델로 변화되어 다양한 프로그램에서 사용될 수 있다. (설계도를 이용하여 실제로 화면에 나타내지는 인터페이스)

#### DOM이 원본 HTML 소스와 다를 수 있는 두 가지 케이스

