---
title: "💻 01. HTTP 개요"
categories: network
tags: [ network ]
---

# HTTP 개요

네트워크를 공부하기 위해 developer.mozilla.org의 [HTTP Overview](https://developer.mozilla.org/ko/docs/Web/HTTP) 문서를 요약 정리하였습니다.

## HTTP란?

HTTP(HyperText Transfer Protocol)은 www 상에서 정보를 주고 받을 수 있는 프로토콜으로 웹에서 이루어지는 모든 데이터 교환의 기초라 할 수 있습니다. 애플리케이션 계층의 확장 가능한 클라이언트-서버 프로토콜입니다. 

### 프로토콜

통신 프로토콜(규약, Protocal)이란 데이터를 주고 받는(통신) 상호 간에 이 과정을 원활하게 하도록 해주는 미리 약속된 규칙을 말합니다. 사람과 사람이 통신할 때 서로 이해할 수 있는 언어를 사용해야 대화를 할 수 있는 것처럼, 컴퓨터와 컴퓨터 사이에도 통신을 하기 위해서는 프로토콜이 있어야 합니다.



### 네트워크 계층

![nextwork layer](https://t1.daumcdn.net/cfile/tistory/260DEE4355B6808D26)

HTTP는 애플리케이션 계층의 프로토콜입니다. 인터넷의 복잡함과 거대한 구조로 인해 네트워크 설계자는 인터넷을 계층화하여 설계하였습니다. [네트워크 계층](https://the-brain-of-sic2.tistory.com/49)에서 애플리케이션 계층은 위와 같이 최상위에 위치하고 있습니다.  HTTP는 애플리케이션 계층에 위치하고 있으며, TCP를 전송 계층으로 사용합니다.



## HTTP 기반 시스템의 구성 요소

HTTP 기반 시스템의 구성 요소는 크게 **클라이언트(사용자 에이전트)**와 **웹 서버**, 그리고 그 중계자 역할을 하는 **프록시**로 구성됩니다. 


### 클라이언트: 사용자 에이전트

사용자 에이전트는 사용자를 대신하여 동작하는 모든 도구를 말하고, 주로 브라우저에 의해 수행됩니다. 브라우저는 항상 요청을 보내는 개체이고 서버가 될 수 없습니다. 웹 페이지를 표시하기 위해서 브라우저는 **HTML 문서에 대한 요청**하고, 스크립트 및 레이아웃 정보에 대해 **추가적인 요청**을하고, 받은 **리소스를 혼합**하는 과정을 거칩니다. **하이퍼 텍스트 문서**인 웹 페이지는 새로운 웹페이지를 가져오기 위한 링크를 포함하고 있는데, 브라우저는 HTTP 요청 내에서 이러한 지시 사항을 변환하고 응답을 해석해서 사용자에게 명확한 응답을 표시합니다.

### 웹 서버

(논리적으로) 단일 기계인 서버는 위와 같은 요청에 문서를 제공합니다. 여러 개의 서버를 동일한 머신 위에 호스팅할 수 있습니다.

### 프록시

![프록시](https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Open_proxy_h2g2bob.svg/350px-Open_proxy_h2g2bob.svg.png)

클라이언트와 서버 사이에서 동작하는 머신들 중 특히 **애플리케이션 계층**에서 동작하는 것을 **프록시**라고 부릅니다. 프록시는 캐싱, 필터링, 로드 밸런싱, 인증, 로깅 등 다양한 기능을 수행합니다. 



## HTTP 기초

HTTP는 **간단**합니다. HTTP 메시지를 프레임별로 캡슐화하여 간결함을 유지한 덕분에 사람이 읽고 이해할 수 있어 테스트하기 쉽습니다. 

HTTP는 **확장 가능**합니다. HTTP 헤더를 통해 새로운 기능을 추가할 수 있습니다. 

HTTP는 **상태가 없습니다(Stateless)**. 클라이언트와의 첫 번째 통신에서 데이터를 주고 받았다고 해도, 두 번째 통신에서 이전 데이터를 유지하지 않습니다. 그러나 HTTP는 쿠키를 통해 상태가 있는 **세션**을 만들어 통신과 통신 사이에 연속성을 만들어줄 수 있습니다.

HTTP의 **연결**은 신뢰할 수 있는 전송 프로토콜인 TCP에 기반합니다. 따라서 클라이언트와 서버가 HTTP를 요청/응답으로 교환하기 전에 TCP 연결을 설정해야 합니다. **HTTP/1.0** 때는 **각 요청/응답에 대해 별도의 TCP 연결**을 열었습니다. **HTTP/1.1**은 **파이프라이닝과 지속적인 연결** 개념을 도입해 이전 버전의 비효율성을 개선하고자 했습니다. 이후 **HTTP/2**는 **단일 연결 상에서 메시지를 다중 전송(multiplex)**하여 연결을 좀 더 지속적이고 효율적으로 유지하도록 하였습니다.

> [파이프라이닝](https://jokerkwu.tistory.com/120) 이란?: 동시에 여러 개의 명령어를 처리함으로써 처리량을 올리는 기법이다.

## HTTP로 제어할 수 있는 것

### 캐시

HTTP는 문서가 캐시되는 방식을 제어할 수 있습니다. 서버는 캐시 대상과 기간을 프록시와 클라이언트에 지시할 수 있고, 클라이언트는 저장된 문서를 무시하라고 중간 캐시 프록시에 지시할 수 있습니다.

> [캐시](https://developer.mozilla.org/ko/docs/Web/HTTP/Caching)란? 데이터나 값을 미리 복사해 놓는 임시 저장소를 카리킨다. 캐시에 데이터를 미리 복사해 놓으면 계산이나 접근 시간 없이 빠른 속도로 데이터에 접근할 수 있다. 캐시는 시스템의 효율성을 위해 여러 분야에서 두루 쓰이고 있다. HTTP에서 캐싱은 보통 GET 요청에서 가져온 리소스를 저장해두고 재사용하여 성능을 높인다. 

###  origin 제약사항 완화

브라우저는 동일한 origin으로부터 온 페이지만이 웹 페이지의 전체 정보에 접근할 수 있게 합니다(same-origin policy). 그러나 HTTP헤더를 통해 이러한 제약사항을 완화하여 다른 도메인으로부터 전달된 정보를 짜 맞출 수 있습니다.

> [스누핑](https://saladdaily.tistory.com/13)이란? 네트워크 상의 정보를 염담하여 불법적으로 얻는 것을 의미한다. 소프트웨어 프로그램(스누퍼)를 통해서 원격으로 다른 컴퓨터의 정보를 엿볼 수 있어 개인적인 메신저 내용, 로그인 정보, 전자 우편 등의 정보를 몰래 획득할 수 있다. 네트워크 트래픽을 분석하기 위해 사용되기도 한다.

> [동일-출처 정책(same-origin policy)](https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy) 이란? 어떤 출처에서 불러온 문서나 스크립트가 다른 출처에서 가져온 리소스와 상호작용하는 것을 제한하는 보안 방식이다. 

### 인증

WWW-Authenticate 혹은 유사한 헤더를 사용해 기본 인증을 거치거나 쿠키로 특정 세션을 설정함으로써 웹페이지를 보호하여 특정 사용자만이 접근할 수 있게 합니다.

### 프록시와 터널링

서버 혹은 클라이언트는 인트라넷에 위치하여 실제 주소를 숨기기도 하는데, 이때 HTTP 요청은 네트워크 장벽을 가로지르기 위해 프록시를 통해 나갑니다.

### 세션

HTTP는 기본적으로 상태가 없습니다. 하지만, 실제로는 데이터 유지가 필요한 경우가 많습니다. 정보가 유지되자 않으면 매번 페이지를 이동할 때마다 로그인을 해야 하고, 상품을 선택하고도 구매 페이지에 선택한 상품이 없을 것이기 때문입니다. HTTP 쿠키는 세션을 만들어 서버 상태를 요청과 연결하도록 해줘 이에 대처합니다.

> 쿠키는 브라우저에 저장되는 작은 데이터 조각으로 임시 데이터 보관 혹은 웹 페이지 개인화에 사용된다. 

## HTTP 흐름

1. TCP 연결을 연다.
2. HTTP 메시지를 전송한다.
3. 서버에 의해 전송된 응답을 읽어들인다.
4. 연결을 닫거나 다른 요청들을 위해 재사용한다. 



## HTTP 메시지

HTTP/2부터는 HTTP 메시지가 프레임 안으로 캡슐화하여 복잡해졌지만, 애플리케이션의 관점에서 볼 때 메시지의 구조는 동일합니다.

### 요청

![HTTP 요청 메시지](https://mdn.mozillademos.org/files/13687/HTTP_Request.png)

- **Method**: ex) GET, POST, OPTIONS, HEAD 
- **Path**: 프로토콜(http://), 도메인(developer.mozilla.org), TCP 포트(80)을 제외한 리소스의 URL
- **Headers** 부가적인 정보 제공



### 응답

![HTTP 응답 메시지](https://mdn.mozillademos.org/files/13691/HTTP_Response.png)

- **HTTP Headers**: ex) User-Agent, Referer, If-Modified-Since, If-None-Match, 쿠키 등 정보 포함



## HTTP 기반 API

- `XMLHttpRequest API`: 전체 페이지의 새로고침 없이도 URL로부터 데이터를 받아올 수 있습니다. 즉, 페이지의 일부를 업데이트할 수 있게 해줍니다. 
- `Fetch API`: 최신 API로 `XMLHttpRequest`와 비슷한 기능을 수행하지만 보다 강력하고 유연한 조작이 가능합니다. 
- `Server-sent Events`: 원래 웹페이지는 새로운 데이터를 받으려면 서버로 요청을 보내야 합니다. 그러나 Server-sent 방식으로는 요청 없이도 언제든지 서버가 새로운 데이터를 보내는 것이 가능합니다. 클라이언트는 도착한 메시지를 Event 객체로 자동 변환해 웹페이지 안에서 Events + 데이터로 다룰 수 있습니다.